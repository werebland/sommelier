!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).stickyEvents={})}(this,function(e){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n={CHANGE:"sticky-change",STUCK:"sticky-stuck",UNSTUCK:"sticky-unstuck"},s={SENTINEL:"sticky-events--sentinel",SENTINEL_TOP:"sticky-events--sentinel-top",SENTINEL_BOTTOM:"sticky-events--sentinel-bottom"},a=".sticky-events",t=function(){function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.container,n=void 0===t?document:t,o=e.enabled,i=void 0===o||o,r=e.stickySelector,s=void 0===r?a:r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),this.container=n,this.observers=[],this.stickyElements=document.querySelectorAll(s),this.stickySelector=s,i&&this.enableEvents()}var e,t,n;return e=c,(t=[{key:"enableEvents",value:function(){r(this.container,this.observers,this.stickySelector)}},{key:"disableEvents",value:function(){i(!(0<arguments.length&&void 0!==arguments[0])||arguments[0],this.observers,this.stickySelector)}}])&&o(e.prototype,t),n&&o(e,n),c}();t.CHANGE=n.CHANGE,t.STUCK=n.STUCK,t.UNSTUCK=n.UNSTUCK;var c=[];function i(){var i=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a;e.forEach(function(e){var t=e.container,n=e.observer,o=e.sentinels;i&&Array.from(t.querySelectorAll(r)).forEach(function(e){return v(!1,e)}),o.forEach(function(e){return e.remove()}),n.disconnect(),n=null}),e.length=0}function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a;window.self===window.top?(t.push(function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a,t=new IntersectionObserver(function(e){e.forEach(function(e){var t=e.boundingClientRect,n=e.rootBounds,o=e.target.parentElement,i=o.querySelector(r);o.style.position="relative",t.bottom>n.top&&t.bottom<n.bottom?v(!1,i):t.bottom<=n.top&&v(!0,i)})},Object.assign({threshold:[0]},!(e instanceof HTMLDocument)&&{root:e})),n=l(e,s.SENTINEL_TOP,r);return n.forEach(function(e){return t.observe(e)}),{container:e,observer:t,sentinels:n}}(e,n)),t.push(function(e){var u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a,t=new IntersectionObserver(function(e){e.forEach(function(e){var t,n,o,i,r,s,c=e.boundingClientRect,a=e.rootBounds,l=e.target.parentElement.querySelector(u);c.top<a.top&&c.bottom<a.bottom?v(!1,l):c.bottom>a.top&&(n=(t=l).previousElementSibling,o=t.getBoundingClientRect().top,i=n.getBoundingClientRect().top,r=Math.round(Math.abs(o-i)),s=Math.abs(parseInt(window.getComputedStyle(n).getPropertyValue("top"))),r!==s)&&v(!0,l)})},Object.assign({threshold:[1]},!(e instanceof HTMLDocument)&&{root:e})),n=l(e,s.SENTINEL_BOTTOM,u);return n.forEach(function(e){return t.observe(e)}),{container:e,observer:t,sentinels:n}}(e,n))):console.warn("StickyEvents: There are issues with using IntersectionObservers in an iframe, canceling initialization. Please see https://github.com/w3c/IntersectionObserver/issues/183")}function v(e,t){t.dispatchEvent(new CustomEvent(n.CHANGE,{detail:{isSticky:e}})),t.dispatchEvent(new CustomEvent(e?n.STUCK:n.UNSTUCK))}function l(e,o){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a;return Array.from(e.querySelectorAll(t)).map(function(e){var t=document.createElement("div"),n=e.parentElement;switch(e.style.cssText="\n      position: -webkit-sticky;\n      position: sticky;\n    ",t.classList.add(s.SENTINEL,o),Object.assign(t.style,{left:0,position:"absolute",right:0,visibility:"hidden"}),o){case s.SENTINEL_TOP:n.insertBefore(t,e),Object.assign(t.style,u(e,t,o),{position:"relative"});break;case s.SENTINEL_BOTTOM:n.appendChild(t),Object.assign(t.style,u(e,t,o))}return t})}function u(e,t,n){var o=window.getComputedStyle(e),i=window.getComputedStyle(e.parentElement);switch(n){case s.SENTINEL_TOP:return{top:"calc(".concat(o.getPropertyValue("top")," * -1)"),height:0};case s.SENTINEL_BOTTOM:var r=parseInt(i.paddingTop);return{bottom:o.top,height:"".concat(e.getBoundingClientRect().height+r,"px")}}}e.StickyEvent=n,e.default=t,e.unobserveStickyEvents=i,e.observeStickyEvents=r,Object.defineProperty(e,"__esModule",{value:!0})});
